function P = interpolation(X)

T0 = X(1);
T1 = X(2);
T2 = X(3);
T3 = X(4);
a0 = X(5);
a1 = X(6);
a2 = X(7);
a3 = X(8);

b=[a0;a1;a2;a3;0;0;0;0;0;0;a1;a2];

A=[0 0 0 1 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 1 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 1;
   0 0 0 0 0 0 0 0 (T3-T2)^3 (T3-T2)^2 (T3-T2) 1;
   0 0 1 0 0 0 0 0 0 0 0 0;
   3*T1^2 2*T1 1 0 0 0 -1 0 0 0 0 0;
   0 0 0 0 3*(T2-T1)^2 2*(T2-T1) 1 0 0 0 -1 0;
   0 0 0 0 0 0 0 0 3*(T3-T2)^2 2*(T3-T2) 1 0;
   6*T1 2 0 0 0 -2 0 0 0 0 0 0;
   0 0 0 0 6*(T2-T1) 2 0 0 0 -2 0 0;
    T1^3 T1^2 T1 1 0 0 0 0 0 0 0 0;
    0 0 0 0 (T2-T1)^3 (T2-T1)^2 (T2-T1) 1 0 0 0 0];
y=A^-1*b;

t=0:0.01:T1;
P1=y(1)*t.^3+y(2)*t.^2+y(3)*t+y(4);

t1=T1:0.01:T2;
P2=y(5)*(t1-T1).^3+y(6)*(t1-T1).^2+y(7)*(t1-T1)+y(8);

t2=T2:0.01:T3;
P3=y(9)*(t2-T2).^3+y(10)*(t2-T2).^2+y(11)*(t2-T2)+y(12);  

P = [P1 P2(2:end) P3(2:end)];
end